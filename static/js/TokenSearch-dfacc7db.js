import{z as e,ak as l,u as a,c as t,r as i,w as s,f as r,a as c,k as n,b as o,t as d,B as u,i as v,al as p,p as m,g,j as f,h as y,F as _,l as w,aj as h,o as k,am as b,n as $,an as x,v as B,x as S,E as C,K as U,s as N,y as j}from"./vendor-c73ab416.js";import{_ as I,c as M,d as T,e as L,C as V,f as A,g as D}from"./index-c220839c.js";import{_ as E}from"./link_icon-99751368.js";const P=e=>(B("data-v-c594c2b4"),e=e(),S(),e),z={class:"searchCoin"},F={class:"etchMiddle mw"},W=P((()=>o("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},[o("path",{d:"M723.781818 986.414545c-11.915636 0-23.831273-4.538182-32.907636-13.637818L263.005091 544.907636c-18.176-18.176-18.176-47.639273 0-65.815272L690.874182 51.223273c18.176-18.176 47.639273-18.176 65.838545 0 18.176 18.176 18.176 47.639273 0 65.815272L361.751273 512l394.961454 394.961455c18.176 18.176 18.176 47.639273 0 65.838545-9.099636 9.076364-21.015273 13.614545-32.930909 13.614545z",fill:"#ffffff"})],-1))),Z=P((()=>o("div",{class:"herder"},null,-1))),R={class:"balanceSplit"},H={class:"balance"},q={key:0,class:"tick"},K={class:"tick_txt"},G={class:"erc20"},J=["src"],O={key:1,class:"tick_all"},Q={class:"pop_select"},X={class:"list"},Y=["onClick"],ee={class:"type"},le=["src"],ae=P((()=>o("span",null,"Available balance:",-1))),te={class:"num",style:{"margin-left":"10px"}},ie={class:"list"},se={class:"result"},re={class:"num"},ce={class:"type"},ne={class:"link"},oe={key:0},de={key:1},ue={class:"table"},ve={key:0,class:"tableList"},pe={class:"img"},me=["src"],ge={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none"},fe=[N('<g clip-path="url(#swoosh-icon-green_svg__a)" opacity="0.65" data-v-c594c2b4><path fill="#4EFCC7" d="M8 14.667A6.667 6.667 0 1 0 8 1.334a6.667 6.667 0 0 0 0 13.333ZM8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16Z" data-v-c594c2b4></path><path stroke="#4EFCC7" stroke-width="1.3" d="m5 8 2.5 2.5L12 6" data-v-c594c2b4></path></g><defs data-v-c594c2b4><clipPath id="swoosh-icon-green_svg__a" data-v-c594c2b4><path fill="#4EFCC7" d="M0 0h16v16H0z" data-v-c594c2b4></path></clipPath></defs>',2)],ye={class:"typeList"},_e={class:"priceType"},we={class:"bsc_price"},he={class:"bsc_price",style:{"font-size":"15px",color:"#999"}},ke={class:"lianEtch"},be={style:{display:"flex","align-items":"center"}},$e=P((()=>o("img",{style:{width:"20px","margin-right":"8px"},src:A,alt:""},null,-1))),xe={class:"lianEtch"},Be=["href"],Se=P((()=>o("img",{style:{width:"14px","margin-left":"4px"},src:E,alt:""},null,-1))),Ce={class:"btl_list"},Ue=["onClick"],Ne={key:1,class:"main"},je={class:"top"},Ie={class:"tick"},Me=["src"],Te={class:"tag"},Le={class:"num"},Ve={class:"bottom"},Ae={class:"row"},De=P((()=>o("div",{class:"col_left"},"#",-1))),Ee={class:"col_right"},Pe={class:"pageNum"},ze={class:"MuiPagination-ul"},Fe={class:"header"},We={class:"tick"},Ze={class:"p"},Re={class:"main"},He={class:"erc20"},qe={class:"top"},Ke={class:"tick"},Ge=["src"],Je={class:"tag"},Oe={class:"num"},Qe=P((()=>o("div",{class:"bottom"},null,-1))),Xe={class:"inp"},Ye={class:"row"},el=P((()=>o("div",{class:"col"},"Price",-1))),ll={class:"col"},al={class:"row"},tl=P((()=>o("div",{class:"col"},"Total Pay",-1))),il={class:"col"},sl={class:"footer"};var rl=I({__name:"TokenSearch",setup(B){const{proxy:S}=j(),N=e(),I=l(),A=a(),E=t((()=>I.query.a||""));function P(){N.push({name:"Tokens"})}!E.value&&P();const rl=i(),cl=i(),nl=i("");s(nl,(()=>nl.value=String(nl.value||"").trim()));const ol=()=>{var e,l;null==(l=null==(e=v(cl).popperRef)?void 0:e.delayHide)||l.call(e)},dl=i({});function ul(e){kl.value=e.project_id,dl.value=e,v(cl).hide()}const{list:vl,getData:pl}=M(),{getData:ml,size:gl,page:fl,type:yl,total:_l,list:wl,balance:hl,id:kl}=T("",15,E.value);function bl(e){yl.value=e,fl.value=1}pl(),ml();const $l=t((()=>A.state.wallet.bnbToUsdt));function xl(e){let l=new S.$web3.utils.BN(String(e||"0")),a=new S.$web3.utils.BN(String($l.value||"0"));return(Number(S.$web3.utils.fromWei(l.mul(a).toString()))/1e8).toFixed(4)}function Bl(e,l){let a=new S.$web3.utils.BN(String(l||"0")),t=new S.$web3.utils.BN(String($l.value||"0")),i=new S.$web3.utils.BN(String(e||"0"));return(Number(S.$web3.utils.fromWei(a.mul(t).mul(i).toString()))/1e8).toFixed(2)}function Sl(e,l){let a=new S.$web3.utils.BN(String(l||"0")),t=new S.$web3.utils.BN(String(e||"0"));return S.$web3.utils.fromWei(a.mul(t).toString())}const Cl=t((()=>A.state.wallet.ticks)),Ul=D(),Nl=t((()=>A.state.wallet.address)),jl=i(!1),Il=i({}),Ml=L(),Tl=i(""),Ll=t((()=>{var e;let l=0;return(null==(e=Il.value)?void 0:e.order_id)&&(l=Number(Il.value.order_amt||0)-Number(Il.value.buy_lim||0)),l}));function Vl(e){let l=new S.$web3.utils.BN(String(e||"0")),a=new S.$web3.utils.BN(String(Tl.value||"0"));return S.$web3.utils.fromWei(l.mul(a).toString())}return s(Tl,(()=>Tl.value=String(Tl.value||"").replace(/^0|\D/g,""))),(e,l)=>{const a=r("page-header"),t=r("van-icon"),i=r("el-button"),s=r("el-input"),B=r("el-popover"),N=r("el-dropdown-item"),j=r("el-dropdown-menu"),M=r("el-dropdown"),T=r("el-tooltip"),L=r("el-tag"),D=r("el-pagination"),$l=r("el-dialog");return k(),c("div",z,[n(a),o("div",F,[o("div",{class:"backRow",onClick:P},[W,o("p",null,d(E.value),1)]),Z,o("div",R,[o("div",H,[o("div",null,[u((k(),c("div",{title:"click to select tick",class:"select_btn",ref_key:"buttonRef",ref:rl},[dl.value&&dl.value.project_id?(k(),c("div",q,[o("span",K,d(dl.value.tick),1),o("span",G,d(dl.value.p),1),e.$Utils.getSrcById(dl.value.project_id)?(k(),c("img",{key:0,src:e.$Utils.getSrcById(dl.value.project_id),style:{width:"20px",height:"20px"}},null,8,J)):m("",!0),v(I).query.id?m("",!0):(k(),g(t,{key:1,name:"arrow-down"}))])):(k(),c("div",O,[f("All Ticks "),n(t,{name:"arrow-down"})]))])),[[v(p),ol]]),n(B,{width:"300","popper-class":"other_select_user",placement:"right-start",ref_key:"popoverRef",ref:cl,"virtual-ref":rl.value,trigger:"click","virtual-triggering":""},{default:y((()=>[o("div",Q,[n(s,{placeholder:"Enter the tick",modelValue:nl.value,"onUpdate:modelValue":l[1]||(l[1]=e=>nl.value=e)},{append:y((()=>[n(i,{icon:v(b),onClick:l[0]||(l[0]=e=>v(pl)(nl.value))},null,8,["icon"])])),_:1},8,["modelValue"]),o("div",X,[o("div",{class:"tick_main",onClick:l[2]||(l[2]=e=>ul({id:0}))},[o("span",{class:$(["tick",{active:!v(kl)}])},"All Tick",2)]),(k(!0),c(_,null,w(v(vl),(l=>(k(),c("div",{class:"tick_main",key:l.project_id,onClick:e=>ul(l)},[o("span",{class:$(["tick",{active:v(kl)==l.project_id}])},d(l.tick),3),o("span",ee,d(l.p),1),e.$Utils.getSrcById(l.project_id)?(k(),c("img",{key:0,src:e.$Utils.getSrcById(l.project_id),style:{width:"20px",height:"20px"}},null,8,le)):m("",!0)],8,Y)))),128))])])])),_:1},8,["virtual-ref"])]),o("div",null,[ae,o("span",te,d(v(hl)||0),1)])])]),o("div",ie,[o("div",se,[o("div",re,[f("Result: "),o("span",null,d(v(_l)),1),n(t,{name:"replay",onClick:v(ml)},null,8,["onClick"])]),o("div",ce,[n(M,{trigger:"click",onCommand:bl},{dropdown:y((()=>[n(j,null,{default:y((()=>[n(N,{command:0},{default:y((()=>[f("Not Sell")])),_:1}),n(N,{command:1},{default:y((()=>[f("In Sell")])),_:1})])),_:1})])),default:y((()=>[o("div",ne,[0===v(yl)?(k(),c("span",oe,"Not Sell")):m("",!0),1===v(yl)?(k(),c("span",de,"In Sell")):m("",!0),n(t,{name:"arrow-down"})])])),_:1})])]),o("div",ue,[(k(!0),c(_,null,w(v(wl),(l=>{return k(),c("div",{class:"item",key:l.id},["onSell"===l.status?(k(),c("div",ve,[o("div",pe,[o("p",null,d(l.tick),1),e.$Utils.getSrcById(l.project_id)?(k(),c("img",{key:0,src:e.$Utils.getSrcById(l.project_id),style:{width:"20px",height:"20px"}},null,8,me)):(k(),c("svg",ge,fe))]),o("div",ye,[o("p",null,d(l.p),1),o("p",null,d((l.op||"Mint").toLowerCase()),1)]),o("div",_e,[o("p",null,d(e.$Utils.orderDiv(l.order_amt,l.buy_lim)),1),o("div",we,d(e.$Utils.rpZero((a=l.price,S.$web3.utils.fromWei(String(a||"0")))))+" BNB / "+d(l.tick),1),o("div",he,"â‰ˆ $"+d(xl(l.price)),1)]),o("div",ke,[o("p",be,[$e,f(" "+d(e.$Utils.rpZero(Sl(e.$Utils.orderDiv(l.order_amt,l.buy_lim),l.price))||"0"),1)]),o("p",null,d(e.$Utils.formatAddress(l.seller)),1)]),o("div",xe,[o("p",null,"$"+d(Bl(e.$Utils.orderDiv(l.order_amt,l.buy_lim),l.price)),1),o("p",null,[n(T,{placement:"top",content:l.order_id},{default:y((()=>[o("a",{target:"_blank",href:e.$Config.browser+"/tx/"+l.hash,style:{display:"flex","align-items":"center",color:"#ffffff"}},[f("#"+d(l.blockNumber)+" ",1),Se],8,Be)])),_:2},1032,["content"])])]),o("div",Ce,[o("div",{class:"buy",onClick:e=>{var a;(a=l).order_id&&(Il.value=a,jl.value=!0)}},"Buy",8,Ue),n(V,{active:!!Cl.value[l.order_id],onClick:e=>v(A).commit("wallet/changeTicks",l.order_id)},null,8,["active","onClick"])])])):(k(),c("div",Ne,[o("div",je,[o("div",Ie,[o("span",null,d(l.tick),1),e.$Utils.getSrcById(l.project_id)?(k(),c("img",{key:0,src:e.$Utils.getSrcById(l.project_id),style:{width:"20px",height:"20px"}},null,8,Me)):(k(),g(t,{key:1,style:{color:"#17d417"},name:"checked"}))]),o("div",Te,[n(L,{type:"info"},{default:y((()=>[f(d(l.p),1)])),_:2},1024),n(L,{type:"info"},{default:y((()=>[f(d((l.op||"Mint").toLowerCase()),1)])),_:2},1024)]),o("div",Le,d(e.$Utils.rpZero(l.balance||"0")),1)]),o("div",Ve,[o("div",Ae,[De,o("div",Ee,d(e.$Utils.formatAddress(l.user)),1)])])]))]);var a})),128))])]),o("div",null,[o("div",Pe,[o("div",ze,[n(D,{"hide-on-single-page":"",background:"","page-size":v(gl),"current-page":v(fl),"onUpdate:currentPage":l[3]||(l[3]=e=>h(fl)?fl.value=e:null),layout:"prev, pager, next",total:v(_l)},null,8,["page-size","current-page","total"])])])])]),n($l,{class:"searchBuyDialog",modelValue:jl.value,"onUpdate:modelValue":l[8]||(l[8]=e=>jl.value=e),width:"400px","close-on-click-modal":!1},{header:y((()=>[o("div",Fe,[f("Buy "),o("span",We,d(Il.value.tick),1),f(),o("span",Ze,d(Il.value.p),1),f(" for buy ")])])),footer:y((()=>[o("div",sl,[n(i,{class:"btn_cancel",onClick:l[6]||(l[6]=e=>jl.value=!1)},{default:y((()=>[f("Cancel")])),_:1}),n(i,{class:"btn_listing",onClick:l[7]||(l[7]=e=>async function(e){if(!Nl.value)return C.warning("please connect the wallet"),!1;if(!e.order_id)return C.warning("error data"),!1;if(Number(Tl.value)<=0)return C.warning("Please enter the buy amount");let l=U.service({text:"Buy transition....",lock:!0,background:"rgba(0,0,0,0.5)"}),{data:a}=await Ml([e.order_id]);if(!(null==a?void 0:a.length))return C.error("error data"),l.close();if(Il.value=a[0],Number(Tl.value)>Number(Ll.value))return C.warning("The max buy amount is "+Ll.value),l.close();let t=await Ul(Nl.value,Il.value.order_id,Tl.value);if(200!==t.code)return C.error(t.msg),l.close();let i=S.$Contract.control.methods.buy(t.data.order_id,t.data.project_id,t.data.order_amt,t.data.buy_amt,t.data.price,t.data.seller,t.data.deadline,t.data.signature).encodeABI(),s=await S.$sendTransition(S.$Contract.control._address,i,t.data.price);s.status?(jl.value=!1,Tl.value="",await S.$statusByHash(s.hash),await S.$Utils.sleep(1e4),ml(),C.success("Purchase transaction initiated")):C.error(s.msg||"buy fail"),l.close()}(Il.value))},{default:y((()=>[f("Buy")])),_:1})])])),default:y((()=>[o("div",Re,[o("div",null,[o("div",He,[o("div",qe,[o("div",Ke,[o("span",null,d(Il.value.tick),1),e.$Utils.getSrcById(Il.value.project_id)?(k(),c("img",{key:0,src:e.$Utils.getSrcById(Il.value.project_id),style:{width:"20px",height:"20px"}},null,8,Ge)):(k(),g(t,{key:1,style:{color:"#17d417"},name:"checked"}))]),o("div",Je,[n(L,{type:"info"},{default:y((()=>[f(d(Il.value.p),1)])),_:1}),n(L,{type:"info"},{default:y((()=>[f(d((Il.value.op||"Mint").toLowerCase()),1)])),_:1})]),o("div",Oe,d(e.$Utils.orderDiv(Il.value.order_amt,Il.value.buy_lim)),1),Qe])]),o("div",Xe,[n(s,{maxlength:"12",modelValue:Tl.value,"onUpdate:modelValue":l[5]||(l[5]=e=>Tl.value=e),placeholder:"Enter the buy amount"},{suffix:y((()=>[o("span",{onClick:l[4]||(l[4]=x((e=>Tl.value=Ll.value),["stop"])),style:{cursor:"pointer"}},"Max")])),_:1},8,["modelValue"])])]),o("div",Ye,[el,o("div",ll,d(e.$Utils.rpZero(e.$web3.utils.fromWei(""+Il.value.price||"0")))+" BNB",1)]),o("div",al,[tl,o("div",il,d(Vl(Il.value.price))+"BNB",1)])])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-c594c2b4"]]);export{rl as default};
